import tkinter as tk
from tkinter import filedialog, messagebox
import pefile  # For analyzing PE files

class MalwareAnalysisTool:
    def __init__(self, master):
        self.master = master
        master.title("Malware Analysis Tool")

        self.label = tk.Label(master, text="Select a file to analyze:")
        self.label.pack()

        self.filepath_entry = tk.Entry(master, width=50)
        self.filepath_entry.pack()

        self.browse_button = tk.Button(master, text="Browse", command=self.browse_file)
        self.browse_button.pack()

        self.analyze_button = tk.Button(master, text="Analyze", command=self.analyze_file)
        self.analyze_button.pack()

        self.result_text = tk.Text(master, height=15, width=80)
        self.result_text.pack()

    def browse_file(self):
        filename = filedialog.askopenfilename()
        self.filepath_entry.delete(0, tk.END)
        self.filepath_entry.insert(0, filename)

    def analyze_file(self):
        filepath = self.filepath_entry.get()
        try:
            pe = pefile.PE(filepath)
            self.result_text.delete(1.0, tk.END)
            self.result_text.insert(tk.END, f"File: {filepath}\n")
            self.result_text.insert(tk.END, f"Number of Sections: {len(pe.sections)}\n")
            self.result_text.insert(tk.END, "Sections:\n")
            for section in pe.sections:
                self.result_text.insert(tk.END, f"  {section.Name.decode().strip()}: {hex(section.VirtualAddress)}\n")
        except Exception as e:
            messagebox.showerror("Error", str(e))

if __name__ == "__main__":
    root = tk.Tk()
    app = MalwareAnalysisTool(root)
    root.mainloop()
